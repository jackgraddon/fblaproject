<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>Cart | Generated</title>
    <link href="../../images/assets/logo/icon.png" rel="icon">
    <meta content="Shop" name="og:title">
    <meta content="Generated" name="og:site_name">
    <meta content="../../images/assets/promos/winter/ogimage.png" name="og:image">
    <meta content="website" name="og:type">
    <meta content="https://generatedprints.com/" name="og:url">
    <meta content="en_US" name="og:locale">

    <!-- PWA -->
    <link href="../../images/assets/logo/generated.png" rel="apple-touch-icon">
    <link rel="manifest" href="../../manifest.json">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <script src="https://kit.fontawesome.com/82aa41a567.js" crossorgin="anonymous"></script>
    <script src="https://kit.fontawesome.com/82aa41a567.js" crossorgin="anonymous"></script>
    <!-- Swiper -->
    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />
    <!-- Personal CSS -->
    <link href="../../css/styles.css" rel="stylesheet">
</head>

<body>
    <div class="nav">
        <a onclick="linkClicked('../../')" id="homelinkM">
            <h1>//Generated</h1>
        </a>
        <div class="d-flex flex-row">
            <a onclick="linkClicked('../../about/')" id="aboutlink" class="pageLink">
                <h5>About</h5>
            </a>
            <a onclick="linkClicked('../../contact/')" id="contactlink" class="pageLink">
                <h5>Contact</h5>
            </a>
            <a onclick="linkClicked('../../')" id="homelink">
                <h1>//Generated</h1>
            </a>
            <a onclick="linkClicked('../../socials/')" id="socialslink" class="pageLink">
                <h5>Socials</h5>
            </a>
            <a onclick="linkClicked('../../shop/')" id="shoplink" class="pageLink">
                <h5>Shop</h5>
            </a>
        </div>
    </div>
    <section id="empty" style="overflow: hidden">
        <div class="fullpage" style="height: 75vh;">
            <div class="textgroup">
                <h2>Your Cart is Empty!</h2>
                <p>Let's get it filled up!</p>
                <a class="btn btn-primary" onclick="linkClicked('../browse/')">Shop Prints</a>
            </div>
        </div>

        <a class="btn btn-primary" onclick="generateCart('test')">Generate Test Cart</a>
    </section>
    <section id="full" style="opacity: 0; display: none; margin-top: 10vh; min-height: 75vh;">
        <div>
            <div class="textgroup">
                <h2>Here's what you've got.</h2>
                <table id="cart">
                </table>
                <form class="buyForm" style="margin-top: 5em;">
                    <h3>Shipping and Billing Address</h3>
                    <label for="fname">Full Name</label>
                    <input class="form-input" type="text" id="fname" name="firstname" placeholder="John M. Doe">
                    <div class="input-group">
                        <span> <label for="adr">Address</label>
                            <input class="form-input" type="text" id="adr" name="address"
                                placeholder="542 W. 15th Street">
                        </span>
                        <span> <label for="city">City</label>
                            <input class="form-input" type="text" id="city" name="city" placeholder="New York">
                        </span>
                        <span>
                            <label for="state">State</label>
                            <input class="form-input" type="text" id="state" name="state" placeholder="NY">
                        </span>
                        <span>
                            <label for="zip">Zip</label>
                            <input class="form-input" type="text" id="zip" name="zip" placeholder="10001">
                        </span>
                    </div>
                    <br>
                    <h3>Payment</h3>
                    <div class="input-group">
                        <span>
                            <label for="cname">Name on Card</label>
                            <input class="form-input" type="text" id="cname" name="cardname"
                                placeholder="John More Doe">
                        </span>
                        <span>
                            <label for="ccnum">Credit card number</label>
                            <input class="form-input" type="text" id="ccnum" name="cardnumber"
                                placeholder="1111222233334444">
                        </span>
                    </div>
                    <div class="input-group">
                        <span>
                            <label for="expmonth">Exp Month</label>
                            <input class="form-input" type="text" id="expmonth" name="expmonth" placeholder="08">
                        </span>
                        <span>
                            <label for="expyear">Exp Year</label>
                            <input class="form-input" type="text" id="expyear" name="expyear" placeholder="2077">
                        </span>
                        <span>
                            <label for="cvv">CVV</label>
                            <input class="form-input" type="text" id="cvv" name="cvv" placeholder="352">
                        </span>
                    </div>
                </form>
                <script>
                    function buyCart() {

                        let street = document.getElementById('adr');
                        let city = document.getElementById('city');
                        let state = document.getElementById('state');
                        let zip = document.getElementById('zip');
                        let cname = document.getElementById('cname');
                        let ccnum = document.getElementById('ccnum');
                        let expmonth = document.getElementById('expmonth');
                        let expyear = document.getElementById('expyear');
                        let cvv = document.getElementById('cvv');

                        if (street.value == '' || city.value == '' || state.value == '' || zip.value == '') {
                            alert('Address filled out incorrectly, please check again.');
                        } else if (cname.value == '' || (ccnum.value == '' || ccnum.value.length < 16) || (expmonth.value == '' || expmonth.value.length != 2) || (expyear.value == '' || expyear.value.length != 4) || (cvv.value == '' || cvv.value.length < 3)) {
                            alert('Payment information filled out incorrectly, please check again.');
                        } else {
                            let address = street.value + " " + city.value + ', ' + state.value + ' ' + zip.value;
                            window.location.href = `./complete/?address=${address}`;
                        }

                    };
                </script>
                <span style="margin-top: 5em;">
                    <a onclick="localStorage.clear(); window.location.reload()" class="btn btn-primary">Clear Cart</a>
                    <a class="btn btn-primary" onclick="buyCart()">Checkout</a>
                </span>
            </div>
        </div>
    </section>
    <div class="footer">
        <h1>//Generated</h1>
        <div class="links">
            <a onclick="linkClicked('../../about/')" id="aboutlink">
                <h5>About</h5>
            </a>
            <a onclick="linkClicked('../../contact/')" id="contactlink">
                <h5>Contact</h5>
            </a>
            <a onclick="linkClicked('../../socials/')" id="socialslink">
                <h5>Socials</h5>
            </a>
            <a onclick="linkClicked('../../shop/')" id="shoplink">
                <h5>Shop</h5>
            </a>
        </div>
    </div>


    <script>
        // Disable Right Click
        document.addEventListener('contextmenu', event => event.preventDefault());
        // Visual Effects when nav link clicked
        function linkClicked(link) {
            gsap.to('body', 0.5, { opacity: 0, ease: "power2.inOut" });
            setTimeout(() => {
                window.location.href = link;
            }, 500);
        }
    </script>
    <!-- Swiper -->
    <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
    <script>
        let swiper = new Swiper();
        function setSwiper() {
            if (window.innerWidth <= 760) {
                swiper = new Swiper('.swiper', {
                    effect: "cards",
                    cardsEffect: {
                        slideShadows: true
                    },
                    grabCursor: true,
                    keyboard: {
                        enabled: true,
                        onlyInViewport: true,
                    },
                });
            } else {
                swiper = new Swiper(".swiper", {
                    slidesPerView: "auto",
                    centeredSlides: true,
                    spaceBetween: 30,
                    keyboard: {
                        enabled: true,
                        onlyInViewport: true,
                    },
                });
            }
        }
        setSwiper();
        window.onresize = setSwiper();
    </script>
    <!-- jsCookie -->
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>
    <!-- Crypto JS -->
    <script src="../../js/crypto-js.js"></script>
    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/CSSRulePlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/TextPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/ScrollToPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/ScrollTrigger.min.js"></script>
    <!-- Swiper -->
    <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
    <!-- Detect Cache and Load Animations -->
    <script>
        // If the page is loaded from cache, refresh it to show up to date content.
        (function () {
            window.onpageshow = function (event) {
                if (event.persisted) {
                    window.location.reload();
                }
            };
        })();

        // Onload effects
        window.onload = function () {
            try {
                window.scrollTo(0, 0);
                gsap.fromTo('body', 0.8, { y: 25, opacity: 0, delay: 0.5, overflowY: 'hidden', ease: "power2.out" }, { delay: 0.5, overflowY: 'visible', y: 0, opacity: 1 });
            } catch (error) {
                console.log(error);
                document.querySelector('body').style.opacity = 1;
                document.querySelector('body').style.display = 'block';
            }
        };
    </script>
    <!-- Load cart -->
    <script>
        let data = JSON.parse(localStorage.getItem("cart")), emptyCart = { "cart": 0, "items": {} }, load = true;;

        console.log("Data", data);
        if (data == null || JSON.stringify(data) === JSON.stringify(emptyCart)) {
            data = emptyCart;
            load = false;
        }
        console.log("Cart", JSON.stringify(emptyCart), emptyCart);
        console.log("Data", JSON.stringify(data), data);
        localStorage.setItem("cart", JSON.stringify(data));

        let items = [];
        function generateCart(info) {
            if (info == 'test') {
                load = true;
                info = {
                    cart: 3,
                    items: {
                        1: {
                            name: "Forest",
                            size: "46in",
                            price: 49.99
                        },
                        2: {
                            name: "Animals",
                            size: "46in",
                            price: 49.99
                        },
                        3: {
                            name: "Snow",
                            size: "36in",
                            price: 59.99
                        }
                    }
                }
                localStorage.setItem('cart', JSON.stringify(info));
            }
            if (load) {
                for (var i in info.items) {
                    items.push([i, info.items[i].name, info.items[i].size, info.items[i].price]);
                }
                let head = document.createElement('tr');
                head.id = `cartHeader`;
                document.getElementById('cart').appendChild(head);

                let name = document.createElement('td')
                name.innerHTML = 'Name';
                name.setAttribute('colspan', '1');
                let size = document.createElement('td')
                size.innerHTML = 'Size';
                size.setAttribute('colspan', '1');
                let price = document.createElement('td')
                price.innerHTML = 'Price (USD)';
                price.setAttribute('colspan', '1');

                head.appendChild(name);
                head.appendChild(size);
                head.appendChild(price);
                for (i = 0; i < items.length; i++) {
                    let item = items[i];
                    console.log(item);

                    let row = document.createElement('tr');
                    row.id = `row${i}`;
                    document.getElementById('cart').appendChild(row);

                    let name = document.createElement('td')
                    name.innerHTML = item[1];
                    let size = document.createElement('td')
                    size.innerHTML = item[2];
                    let price = document.createElement('td')
                    price.innerHTML = item[3];

                    row.appendChild(name);
                    row.appendChild(size);
                    row.appendChild(price);
                }
                try {
                    window.scrollTo(0, 0);
                    gsap.fromTo('#full', 0.8, { y: 25, opacity: 0, delay: 0.5, display: 'block', overflowY: 'hidden', ease: "power2.out" }, { delay: 0.5, overflowY: 'visible', y: 0, opacity: 1 });
                    gsap.to('#empty', 0.8, { opacity: 0, height: 0, display: 'none' })
                } catch (error) {
                    console.log(error);
                    document.getElementById('full').style.opacity = 1;
                    document.getElementById('full').style.display = 'block';
                    document.getElementById('empty').style.display = 'none';
                }
            } else {
                console.log('No cart to load, showing promos.')
            }
        }
        let loader = generateCart(data);
        window.onload = loader;
    </script>
</body>

</html>