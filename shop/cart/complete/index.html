<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>Complete | Generated</title>
    <link href="../../../images/assets/logo/icon.png" rel="icon">
    <meta content="Shop" name="og:title">
    <meta content="Generated" name="og:site_name">
    <meta content="../../../images/assets/promos/winter/ogimage.png" name="og:image">
    <meta content="website" name="og:type">
    <meta content="https://generatedprints.com/" name="og:url">
    <meta content="en_US" name="og:locale">

    <!-- PWA -->
    <link href="../../../images/assets/logo/generated.png" rel="apple-touch-icon">
    <link rel="manifest" href="../../../manifest.json">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <script src="https://kit.fontawesome.com/82aa41a567.js" crossorgin="anonymous"></script>
    <script src="https://kit.fontawesome.com/82aa41a567.js" crossorgin="anonymous"></script>
    <!-- Swiper -->
    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />
    <!-- Personal CSS -->
    <link href="../../../css/styles.css" rel="stylesheet">
    <style>
        @media print {
            .noPrint {
                display: none;
            }

            body {
                color: black !important;
                background-color: white !important;
            }

            #cart {
                width: 80%;
                height: auto;
            }
        }
    </style>
</head>

<body>
    <div class="nav noPrint">
        <a onclick="linkClicked('../../../')" id="homelinkM">
            <h1>//Generated</h1>
        </a>
        <div class="d-flex flex-row">
            <a onclick="linkClicked('../../../about/')" id="aboutlink" class="pageLink">
                <h5>About</h5>
            </a>
            <a onclick="linkClicked('../../../contact/')" id="contactlink" class="pageLink">
                <h5>Contact</h5>
            </a>
            <a onclick="linkClicked('../../../')" id="homelink">
                <h1>//Generated</h1>
            </a>
            <a onclick="linkClicked('../../../socials/')" id="socialslink" class="pageLink">
                <h5>Socials</h5>
            </a>
            <a onclick="linkClicked('../../../shop/')" id="shoplink" class="pageLink">
                <h5>Shop</h5>
            </a>
        </div>
    </div>
    <section id="full" style="margin-top: 10vh; min-height: 75vh;">
        <div>
            <div class="textgroup">
                <h2>Thanks for your order!</h2>
                <p class="noPrint">Your order is being processed.</p>
                <p>Your order number is <span id="orderNum"></span></p>
                <table id="cart">
                </table>
                <script id="orderNumGenerator">
                    const pageAccessedByReload = (
                        (window.performance.navigation && window.performance.navigation.type === 1) ||
                        window.performance
                            .getEntriesByType('navigation')
                            .map((nav) => nav.type)
                            .includes('reload')
                    );
                    // console.log(pageAccessedByReload);
                    let order = document.getElementById('orderNum');
                    if (pageAccessedByReload) {
                        orderNum = window.localStorage.getItem('orderNum');
                        order.innerHTML = orderNum;
                    } else {
                        orderNum = Math.floor(Math.random() * 9999999)
                        order.innerHTML = orderNum;
                        window.localStorage.setItem('orderNum', orderNum)
                    }
                </script>
                <p style="margin-top: 1em;">Your order will be shipped to:</p>
                <p id="address"></p>
            </div>
        </div>
        <a onclick="window.print();" class="btn btn-primary noPrint" style="margin-top: 2em;">
            Print Me
        </a>
        <h5 style="margin-top: 10vh;">Disclaimer</h5>
        <p>This website is a mock business, and you will not recieve any item ordered.</p>
        <p>You were not charged if you entered your credit card information, as we have no way to process this data.</p>
    </section>
    <div class="footer noPrint">
        <h1>//Generated</h1>
        <div class="links">
            <a onclick="linkClicked('../../../about/')" id="aboutlink">
                <h5>About</h5>
            </a>
            <a onclick="linkClicked('../../../contact/')" id="contactlink">
                <h5>Contact</h5>
            </a>
            <a onclick="linkClicked('../../../socials/')" id="socialslink">
                <h5>Socials</h5>
            </a>
            <a onclick="linkClicked('../../../shop/')" id="shoplink">
                <h5>Shop</h5>
            </a>
        </div>
    </div>


    <script>
        // Disable Right Click
        document.addEventListener('contextmenu', event => event.preventDefault());
        // Visual Effects when nav link clicked
        function linkClicked(link) {
            gsap.to('body', 0.5, { opacity: 0, ease: "power2.inOut" });
            setTimeout(() => {
                window.location.href = link;
            }, 500);
        }
    </script>
    <!-- Swiper -->
    <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
    <script>
        let swiper = new Swiper();
        function setSwiper() {
            if (window.innerWidth <= 760) {
                swiper = new Swiper('.swiper', {
                    effect: "cards",
                    cardsEffect: {
                        slideShadows: true
                    },
                    grabCursor: true,
                    keyboard: {
                        enabled: true,
                        onlyInViewport: true,
                    },
                });
            } else {
                swiper = new Swiper(".swiper", {
                    slidesPerView: "auto",
                    centeredSlides: true,
                    spaceBetween: 30,
                    keyboard: {
                        enabled: true,
                        onlyInViewport: true,
                    },
                });
            }
        }
        setSwiper();
        window.onresize = setSwiper();
    </script>
    <!-- jsCookie -->
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>
    <!-- Crypto JS -->
    <script src="../../../js/crypto-js.js"></script>
    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/CSSRulePlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/TextPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/ScrollToPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/ScrollTrigger.min.js"></script>
    <!-- Swiper -->
    <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
    <!-- Detect Cache and Load Animations -->
    <script>
        // If the page is loaded from cache, refresh it to show up to date content.
        (function () {
            window.onpageshow = function (event) {
                if (event.persisted) {
                    window.location.reload();
                }
            };
        })();

        // Onload effects
        window.onload = function () {
            try {
                window.scrollTo(0, 0);
                gsap.fromTo('body', 0.8, { y: 25, opacity: 0, delay: 0.5, overflowY: 'hidden', ease: "power2.out" }, { delay: 0.5, overflowY: 'visible', y: 0, opacity: 1 });
            } catch (error) {
                console.log(error);
                document.querySelector('body').style.opacity = 1;
                document.querySelector('body').style.display = 'block';
            }
        };
    </script>
    <!-- Load cart -->
    <script>
        var url = new URL(window.location.href);
        let itemD = url.searchParams.get('item');
        let sizeD = url.searchParams.get('size');
        let priceD = url.searchParams.get('price')
        let address = url.searchParams.get('address');
        document.getElementById('address').innerHTML = address;
        let data = JSON.parse(localStorage.getItem("cart")), emptyCart = { "cart": 0, "items": {} }, load = true;;

        console.log("Data", data);
        console.log("Cart", JSON.stringify(emptyCart), emptyCart);
        console.log("Data", JSON.stringify(data), data);
        localStorage.setItem("cart", JSON.stringify(data));

        function toTitleCase(str) {
            return str.toLowerCase().split(' ').map(function (word) {
                return (word.charAt(0).toUpperCase() + word.slice(1));
            }).join(' ');
        }

        if (itemD) {
            let head = document.createElement('tr');
            head.id = `cartHeader`;
            document.getElementById('cart').appendChild(head);

            let nameH = document.createElement('td')
            nameH.innerHTML = 'Name';
            nameH.setAttribute('colspan', '1');
            let sizeH = document.createElement('td')
            sizeH.innerHTML = 'Size';
            sizeH.setAttribute('colspan', '1');
            let priceH = document.createElement('td')
            priceH.innerHTML = 'Price (USD)';
            priceH.setAttribute('colspan', '1');

            console.log(itemD);

            let row = document.createElement('tr');
            row.id = `row`;
            document.getElementById('cart').appendChild(row);

            let name = document.createElement('td')
            name.innerHTML = toTitleCase(itemD);
            let size = document.createElement('td')
            size.innerHTML = sizeD;
            let price = document.createElement('td')
            price.innerHTML = priceD;

            head.appendChild(nameH);
            head.appendChild(sizeH);
            head.appendChild(priceH);
            row.appendChild(name);
            row.appendChild(size);
            row.appendChild(price);
            load = false;
        }

        let items = [];
        function generateCart(info) {
            if (load) {
                for (var i in info.items) {
                    items.push([i, info.items[i].name, info.items[i].size, info.items[i].price]);
                }
                let head = document.createElement('tr');
                head.id = `cartHeader`;
                document.getElementById('cart').appendChild(head);

                let name = document.createElement('td')
                name.innerHTML = 'Name';
                name.setAttribute('colspan', '1');
                let size = document.createElement('td')
                size.innerHTML = 'Size';
                size.setAttribute('colspan', '1');
                let price = document.createElement('td')
                price.innerHTML = 'Price (USD)';
                price.setAttribute('colspan', '1');

                head.appendChild(name);
                head.appendChild(size);
                head.appendChild(price);
                for (i = 0; i < items.length; i++) {
                    let item = items[i];
                    console.log(item);

                    let row = document.createElement('tr');
                    row.id = `row${i}`;
                    document.getElementById('cart').appendChild(row);

                    let name = document.createElement('td')
                    name.innerHTML = item[1];
                    let size = document.createElement('td')
                    size.innerHTML = item[2];
                    let price = document.createElement('td')
                    price.innerHTML = item[3];

                    row.appendChild(name);
                    row.appendChild(size);
                    row.appendChild(price);
                }
                try {
                    window.scrollTo(0, 0);
                    gsap.fromTo('#full', 0.8, { y: 25, opacity: 0, delay: 0.5, display: 'block', overflowY: 'hidden', ease: "power2.out" }, { delay: 0.5, overflowY: 'visible', y: 0, opacity: 1 });
                    gsap.to('#empty', 0.8, { opacity: 0, height: 0, display: 'none' })
                } catch (error) {
                    console.log(error);
                    document.getElementById('full').style.opacity = 1;
                    document.getElementById('full').style.display = 'block';
                    document.getElementById('empty').style.display = 'none';
                }
            } else {
                console.log('Loaded cart from URL instead of storage')
            }
        }
        let loader = generateCart(data);
        window.onload = loader;
    </script>
</body>

</html>